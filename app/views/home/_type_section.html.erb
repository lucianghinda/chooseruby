<%# Task 5.4 & Task 4.14-4.15: Type section partial with conditional display and caching
  Accepts locals: type, entries, emoji, title
  Displays a section header with emoji, title, and "View all" link
  Shows 3-4 entry cards in horizontal grid
  Task 4.14: Conditional display logic
  - Hide section completely if entries.count == 0
  - Show section with submission message if entries.count between 1-3
  - Show section normally if entries.count >= 4
  Task 4.15: Fragment caching for performance
%>
<% section_data ||= {} %>

<% if entries.any? %>
  <% cache ["home_type_section", type, entries.maximum(:updated_at)] do %>
    <section class="space-y-8" data: section_data>
      <div class="flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between">
        <div>
          <h2 class="text-3xl font-semibold text-slate-900">
            <span class="mr-2"><%= emoji %></span><%= title %>
          </h2>
          <p class="mt-2 max-w-2xl text-base text-slate-600">
            <%= type_description(type) %>
          </p>
        </div>
        <%= link_to "View all", resource_type_path(type), class: "inline-flex items-center gap-2 text-sm font-semibold text-slate-700 hover:text-rose-500" %>
      </div>

      <div class="grid gap-6 lg:grid-cols-3">
        <% entries.each do |entry| %>
          <a href="<%= resource_path(entry.slug) %>" class="relative block h-full rounded-3xl border border-slate-100 bg-white p-6 shadow-sm transition hover:-translate-y-1 hover:shadow-xl focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-rose-400">
            <div>
              <% if entry.categories.any? %>
                <div class="mb-4 flex flex-wrap gap-2">
                  <% entry.categories.first(3).each do |category| %>
                    <span class="inline-flex items-center rounded-full bg-slate-100 px-3 py-1 text-xs font-medium text-slate-600"><%= category.name %></span>
                  <% end %>
                </div>
              <% end %>

              <h3 class="text-xl font-semibold text-slate-900"><%= entry.title %></h3>

              <% description_text = entry.description.to_plain_text.presence || entry.tags&.join(", ") %>
              <% if description_text.present? %>
                <p class="mt-3 text-sm text-slate-600"><%= truncate(description_text, length: 160) %></p>
              <% end %>
            </div>

            <div class="mt-6 flex items-center justify-between text-sm text-slate-500">
              <div class="flex items-center gap-2">
                <% if entry.experience_level.present? %>
                  <span class="inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600">
                    <span class="h-2 w-2 rounded-full <%= experience_level_badge_color(entry.experience_level) %>"></span>
                    <%= entry.experience_level.capitalize %>
                  </span>
                <% end %>
                <% if entry.authors.any? %>
                  <span>
                    by
                    <%= entry.authors.first(2).map(&:name).to_sentence %>
                    <% remaining = entry.authors.size - 2 %>
                    <%= "+#{remaining}" if remaining.positive? %>
                  </span>
                <% end %>
              </div>
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-rose-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5l7 7-7 7" />
              </svg>
            </div>
          </a>
        <% end %>
      </div>

      <%# Task 4.14: Show submission message if entries count is between 1-3 %>
      <% if entries.count < 4 %>
        <div class="rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-6 py-4 text-center">
          <p class="text-sm text-slate-600">
            <%= submission_message_for_type(type) %>
            <%= link_to "Submit it here", new_resource_submission_path, class: "font-semibold text-rose-600 hover:text-rose-500" %>
          </p>
        </div>
      <% end %>
    </section>
  <% end %>
<% end %>
